# =============================================================================
# NZ Property Tax Document Review System - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED - API Keys
# -----------------------------------------------------------------------------

# Anthropic API Key (REQUIRED)
# Get your key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-xxxx

# -----------------------------------------------------------------------------
# REQUIRED - Database
# -----------------------------------------------------------------------------

# PostgreSQL connection URL (async driver)
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/property_tax

# -----------------------------------------------------------------------------
# OPTIONAL - RAG/Vector Search (Pinecone + OpenAI)
# -----------------------------------------------------------------------------
# Required for transaction pattern learning and skill learnings

# OpenAI API Key (for embeddings)
# Get your key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-xxxx

# Pinecone API Key
# Get your key from: https://app.pinecone.io/
PINECONE_API_KEY=pcsk_xxxx

# Pinecone Index Host URL
# Example: skill-learnings-xxxxx.svc.aped-4627-b74a.pinecone.io
PINECONE_INDEX_HOST=

# Pinecone Namespace (default: skill_learnings)
PINECONE_NAMESPACE=skill_learnings

# -----------------------------------------------------------------------------
# OPTIONAL - Google Maps (Address Autocomplete)
# -----------------------------------------------------------------------------

# Google Maps API Key (requires Places API enabled)
GOOGLE_MAPS_API_KEY=

# -----------------------------------------------------------------------------
# OPTIONAL - Claude Model Selection
# -----------------------------------------------------------------------------

# Available models (December 2025):
# - claude-opus-4-5-20251101    (best accuracy, highest cost)
# - claude-sonnet-4-5-20250929  (excellent balance)
# - claude-sonnet-4-20250514    (fast, good accuracy)
# - claude-haiku-4-5-20251001   (fastest, lowest cost)
CLAUDE_MODEL=claude-opus-4-5-20251101

# -----------------------------------------------------------------------------
# OPTIONAL - Application Settings
# -----------------------------------------------------------------------------

# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Debug mode (set to true for development)
DEBUG=false

# Server settings
HOST=0.0.0.0
PORT=8000

# -----------------------------------------------------------------------------
# OPTIONAL - File Upload Settings
# -----------------------------------------------------------------------------

# Upload directory path
UPLOAD_DIR=./uploads

# Maximum file size in MB
MAX_FILE_SIZE_MB=50

# -----------------------------------------------------------------------------
# OPTIONAL - Processing Settings
# -----------------------------------------------------------------------------

# Number of pages per batch for financial documents
FINANCIAL_DOC_BATCH_SIZE=5

# Maximum concurrent Claude API calls
MAX_CONCURRENT_API_CALLS=3

# Minimum seconds between API requests
MIN_REQUEST_INTERVAL=0.5

# Delay between processing batches
BATCH_DELAY_SECONDS=1.0

# -----------------------------------------------------------------------------
# OPTIONAL - Retry Settings
# -----------------------------------------------------------------------------

# Maximum API retry attempts
MAX_API_RETRIES=5

# Base delay for exponential backoff (seconds)
RETRY_BASE_DELAY=2.0

# Maximum delay between retries (seconds)
RETRY_MAX_DELAY=60.0

# Random jitter added to retry delay (seconds)
RETRY_JITTER=1.0

# -----------------------------------------------------------------------------
# OPTIONAL - Feature Flags
# -----------------------------------------------------------------------------

# Enable batch processing for financial documents
ENABLE_BATCH_PROCESSING=true

# Enable Claude Tool Use for schema enforcement
ENABLE_TOOL_USE=true

# Enable verification pass for extractions
ENABLE_EXTRACTION_VERIFICATION=true

# -----------------------------------------------------------------------------
# OPTIONAL - Knowledge Retrieval Settings
# -----------------------------------------------------------------------------

# Number of relevant learnings to retrieve
KNOWLEDGE_TOP_K=5

# Minimum relevance score for knowledge retrieval (0.0 - 1.0)
KNOWLEDGE_RELEVANCE_THRESHOLD=0.3

# OpenAI embedding model
EMBEDDING_MODEL=text-embedding-3-small

# Embedding dimensions (1536 for text-embedding-3-small)
EMBEDDING_DIMENSIONS=1536
